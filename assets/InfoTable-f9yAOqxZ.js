import{o as n,c as p,w as t,g as l,L as I,I as j,d as b,a as T,b as D,f as v,D as E,r as F,an as q,t as i,e as U,z as G,ag as J,ak as O,q as S,i as L,au as Q,j as W,h as K,M as X,s as Y,v as w,ar as Z}from"./index-DYijHe1n.js";import{V as ee}from"./VTooltip-CUIuH4Mn.js";import{V as te,a as $}from"./filter-y8H242sa.js";import{V as ae}from"./VDataTable-OrWjgmsy.js";const se=D("span",null,[D("span",{class:"attack-and"},"&"),b(" indicates an adaptation from ATT&CK ")],-1),le={__name:"AttackIconToolTip",props:["items"],setup(_){return(g,y)=>_.items.some(u=>"ATT&CK-reference"in u)?(n(),p(ee,{key:0},{activator:t(({props:u})=>[l(I,j({size:"small"},u),{default:t(()=>[b(" mdi-information-outline ")]),_:2},1040)]),default:t(()=>[se]),_:1})):T("",!0)}},z={__name:"TableFilter",props:["categories","stages"],emits:["updateFilters"],setup(_,{emit:g}){const{categories:y,stages:u}=_,N=g,M=v(()=>y?"category":"ML-lifecycle");let o=E(y||u);const c=F([]);function B(){N("updateFilters",M.value,c.value)}const h=F([]);x();async function x(){try{h.value=await q();const d=h.value.map(m=>m.name);o.sort((m,V)=>d.indexOf(m)-d.indexOf(V))}catch(d){console.error("Failed to fetch descriptions:",d),h.value=[]}}return(d,m)=>(n(),p(te,{modelValue:c.value,"onUpdate:modelValue":[m[0]||(m[0]=V=>c.value=V),B],clearable:"",chips:"",label:`Filter by ${M.value==="category"?"category":"ML lifecycle stage"}`,items:i(o),multiple:""},null,8,["modelValue","label","items"]))}},ne={key:0},oe={key:1},re={key:0,class:"attack-and"},ie=["innerHTML"],fe={__name:"InfoTable",props:["items"],setup(_){const{smAndDown:g}=U(),{mdAndUp:y}=U(),u=G("markdownit"),N=J();let{objectTypePlural:M}=N.params;const{items:o}=_,c=E({category:[],"ML-lifecycle":[]}),B=v(()=>c.category.length===0&&c["ML-lifecycle"].length===0?o:o.filter(e=>c.category.every(a=>e.category.includes(a))&&c["ML-lifecycle"].every(a=>e["ML-lifecycle"].includes(a))));function h(e,a){c[e]=a}const x=v(()=>o.reduce((e,a)=>("category"in a&&a.category.forEach(r=>{e.includes(r)||e.push(r)}),e),[])),d=v(()=>o.reduce((e,a)=>("ML-lifecycle"in a&&a["ML-lifecycle"].forEach(r=>{e.includes(r)||e.push(r)}),e),[])),m=v(()=>{let e=[{title:"ID",key:"id",align:y.value?"end":" d-none"},{title:"Name",key:"name",align:"start"}];const a=V.value.map(r=>({value:r,title:O(r),sortable:!1}));return e.concat(a)}),V=v(()=>"columnNames"in o[0]?o[0].columnNames:["description"]),k=F(""),A=v(()=>o[0].columnNames?o[0].columnNames[0]!=="use":!0);let C=F(!1);function H(){C.value=!C.value,k.value=""}function P(e){return e.length>150?e.substring(0,150)+"...":e}return(e,a)=>{const r=Z("router-link");return n(),S("div",null,[l(K,{class:"mb-3"},{default:t(()=>[l(L,{cols:i(g)?12:""},{default:t(()=>[A.value?(n(),p($,{key:0,modelValue:k.value,"onUpdate:modelValue":a[0]||(a[0]=s=>k.value=s),label:"Search for Keywords","append-inner-icon":"mdi-magnify","hide-details":""},null,8,["modelValue"])):(n(),p(K,{key:1,"no-gutters":""},{default:t(()=>[l(Q),l(L,null,{default:t(()=>[i(C)?(n(),p($,{key:0,modelValue:k.value,"onUpdate:modelValue":a[1]||(a[1]=s=>k.value=s),density:"compact",label:"Search for Keywords"},null,8,["modelValue"])):T("",!0)]),_:1}),l(L,{sm:"1"},{default:t(()=>[l(W,{variant:i(C)===!1?"outlined":"text",onClick:H},{default:t(()=>[l(I,null,{default:t(()=>[b("mdi-magnify")]),_:1}),b(" Search ")]),_:1},8,["variant"])]),_:1})]),_:1}))]),_:1},8,["cols"]),x.value.length>0?(n(),p(L,{key:0,cols:i(g)?6:""},{default:t(()=>[l(z,{categories:x.value,onUpdateFilters:h},null,8,["categories"])]),_:1},8,["cols"])):T("",!0),d.value.length>0?(n(),p(L,{key:1,cols:i(g)?6:""},{default:t(()=>[l(z,{stages:d.value,onUpdateFilters:h},null,8,["stages"])]),_:1},8,["cols"])):T("",!0)]),_:1}),l(ae,{items:B.value,headers:m.value,sortBy:i(M)==="studies"?[{key:"id",order:"desc"}]:[],search:k.value,"items-per-page":"-1"},X({"header.name":t(({column:s,isSorted:f,getSortIcon:R})=>[D("span",null,[b(w(s.title)+" ",1),l(le,{items:_.items},null,8,["items"])]),f(s)?(n(),p(I,{key:0,icon:R(s)},null,8,["icon"])):T("",!0)]),"item.id":t(({item:s,value:f})=>[l(r,{to:s.route,class:"pl-5"},{default:t(()=>[b(w(f),1)]),_:2},1032,["to"])]),"item.name":t(({item:s,value:f})=>[l(r,{to:s.route},{default:t(()=>["label"in s?(n(),S("div",ne,w(s.label),1)):(n(),S("div",oe,w(f),1))]),_:2},1032,["to"]),"ATT&CK-reference"in s?(n(),S("span",re,"&")):T("",!0)]),bottom:t(()=>[]),_:2},[Y(V.value,s=>({name:`item.${s}`,fn:t(({value:f})=>[D("div",{class:"pt-5 pb-5",innerHTML:i(y)?i(u).render(f):i(u).render(P(f))},null,8,ie)])}))]),1032,["items","headers","sortBy","search"])])}}};export{fe as _};
