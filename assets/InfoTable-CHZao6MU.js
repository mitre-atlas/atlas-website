import{o as i,a as p,w as t,b as l,L as B,I as j,g as v,x as b,e as S,c as g,D as z,y as w,an as q,m as o,u as I,C as G,ag as J,ak as O,l as U,d as L,au as Q,f as W,V as K,M as X,r as Y,t as N,ar as Z}from"./index-BmQRBLpp.js";import{V as ee}from"./VTooltip-p1xs7P-h.js";import{V as te,a as $}from"./filter-oaT9hLMk.js";import{V as ae}from"./VDataTable-r8czXyK1.js";const se=S("span",null,[S("span",{class:"attack-and"},"&"),v(" indicates an adaptation from ATT&CK ")],-1),le={__name:"AttackIconToolTip",props:["items"],setup(_){return(h,y)=>_.items.some(u=>"ATT&CK-reference"in u)?(i(),p(ee,{key:0},{activator:t(({props:u})=>[l(B,j({size:"small"},u),{default:t(()=>[v(" mdi-information-outline ")]),_:2},1040)]),default:t(()=>[se]),_:1})):b("",!0)}},E={__name:"TableFilter",props:["categories","stages"],emits:["updateFilters"],setup(_,{emit:h}){const{categories:y,stages:u}=_,D=h,x=g(()=>y?"category":"ML-lifecycle");let n=z(y||u);const c=w([]);function F(){D("updateFilters",x.value,c.value)}const V=w([]);C();async function C(){try{V.value=await q();const d=V.value.map(m=>m.name);n.sort((m,k)=>d.indexOf(m)-d.indexOf(k))}catch(d){console.error("Failed to fetch descriptions:",d),V.value=[]}}return(d,m)=>(i(),p(te,{modelValue:c.value,"onUpdate:modelValue":[m[0]||(m[0]=k=>c.value=k),F],clearable:"",chips:"",label:`Filter by ${x.value==="category"?"category":"ML lifecycle stage"}`,items:o(n),multiple:""},null,8,["modelValue","label","items"]))}},ne={key:0,class:"attack-and"},re=["innerHTML"],de={__name:"InfoTable",props:["items"],setup(_){const{smAndDown:h}=I(),{mdAndUp:y}=I(),u=G("markdownit"),D=J();let{objectTypePlural:x}=D.params;const{items:n}=_,c=z({category:[],"ML-lifecycle":[]}),F=g(()=>c.category.length===0&&c["ML-lifecycle"].length===0?n:n.filter(e=>c.category.every(a=>e.category.includes(a))&&c["ML-lifecycle"].every(a=>e["ML-lifecycle"].includes(a))));function V(e,a){c[e]=a}const C=g(()=>n.reduce((e,a)=>("category"in a&&a.category.forEach(r=>{e.includes(r)||e.push(r)}),e),[])),d=g(()=>n.reduce((e,a)=>("ML-lifecycle"in a&&a["ML-lifecycle"].forEach(r=>{e.includes(r)||e.push(r)}),e),[])),m=g(()=>{let e=[{title:"ID",key:"id",align:y.value?"end":" d-none"},{title:"Name",key:"name",align:"start"}];const a=k.value.map(r=>({value:r,title:O(r),sortable:!1}));return e.concat(a)}),k=g(()=>"columnNames"in n[0]?n[0].columnNames:["description"]),T=w(""),A=g(()=>n[0].columnNames?n[0].columnNames[0]!=="use":!0);let M=w(!1);function H(){M.value=!M.value,T.value=""}function P(e){return e.length>150?e.substring(0,150)+"...":e}return(e,a)=>{const r=Z("router-link");return i(),U("div",null,[l(K,{class:"mb-3"},{default:t(()=>[l(L,{cols:o(h)?12:""},{default:t(()=>[A.value?(i(),p($,{key:0,modelValue:T.value,"onUpdate:modelValue":a[0]||(a[0]=s=>T.value=s),label:"Search for Keywords","append-inner-icon":"mdi-magnify","hide-details":""},null,8,["modelValue"])):(i(),p(K,{key:1,"no-gutters":""},{default:t(()=>[l(Q),l(L,null,{default:t(()=>[o(M)?(i(),p($,{key:0,modelValue:T.value,"onUpdate:modelValue":a[1]||(a[1]=s=>T.value=s),density:"compact",label:"Search for Keywords"},null,8,["modelValue"])):b("",!0)]),_:1}),l(L,{sm:"1"},{default:t(()=>[l(W,{variant:o(M)===!1?"outlined":"text",onClick:H},{default:t(()=>[l(B,null,{default:t(()=>[v("mdi-magnify")]),_:1}),v(" Search ")]),_:1},8,["variant"])]),_:1})]),_:1}))]),_:1},8,["cols"]),C.value.length>0?(i(),p(L,{key:0,cols:o(h)?6:""},{default:t(()=>[l(E,{categories:C.value,onUpdateFilters:V},null,8,["categories"])]),_:1},8,["cols"])):b("",!0),d.value.length>0?(i(),p(L,{key:1,cols:o(h)?6:""},{default:t(()=>[l(E,{stages:d.value,onUpdateFilters:V},null,8,["stages"])]),_:1},8,["cols"])):b("",!0)]),_:1}),l(ae,{items:F.value,headers:m.value,sortBy:o(x)==="studies"?[{key:"id",order:"desc"}]:[],search:T.value,"items-per-page":"-1"},X({"header.name":t(({column:s,isSorted:f,getSortIcon:R})=>[S("span",null,[v(N(s.title)+" ",1),l(le,{items:_.items},null,8,["items"])]),f(s)?(i(),p(B,{key:0,icon:R(s)},null,8,["icon"])):b("",!0)]),"item.id":t(({item:s,value:f})=>[l(r,{to:s.route,class:"pl-5"},{default:t(()=>[v(N(f),1)]),_:2},1032,["to"])]),"item.name":t(({item:s,value:f})=>[l(r,{to:s.route},{default:t(()=>[v(N(f),1)]),_:2},1032,["to"]),"ATT&CK-reference"in s?(i(),U("span",ne,"&")):b("",!0)]),bottom:t(()=>[]),_:2},[Y(k.value,s=>({name:`item.${s}`,fn:t(({value:f})=>[S("div",{class:"pt-5 pb-5",innerHTML:o(y)?o(u).render(f):o(u).render(P(f))},null,8,re)])}))]),1032,["items","headers","sortBy","search"])])}}};export{de as _};
