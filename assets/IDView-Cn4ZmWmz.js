import{u as S,o as t,q as s,s as O,c as g,w as c,b as j,t as d,E as x,a as $,F as k,al as A,f as b,am as I,r as B,g as i,h as N,i as w,I as M,d as h,v,J as F,G as P,an as E,ao as L,ap as G,aq as H,L as K,n as q,ar as z,e as R,as as U,ag as J,at as Z}from"./index-CQxo2aw0.js";import{_ as Q}from"./InfoTable-CjS-_9I3.js";import{V as W}from"./VChip-BfTELtMQ.js";import{V as X}from"./VTooltip-D4hvti0T.js";import{b as Y,V as ee}from"./VCard-CLiOrSEm.js";import{_ as te}from"./PageSectionTitle.vue_vue_type_script_setup_true_lang-ebGhgylR.js";import{_ as ae}from"./ErrorNotFoundView.vue_vue_type_script_setup_true_lang-DSETLwmb.js";import"./filter-Thy-FAR1.js";import"./VDataTable-BRzjCjcj.js";const ne=["innerHTML"],se={__name:"RelatedObjsList",props:["parentObject","items","itemType"],setup(a){const r=S(),{parentObject:n,items:m,itemType:o}=a,u=[m][0].sort((e,l)=>e.id>l.id?1:-1);let p=e=>r.getDataObjectById(e).label;return(e,l)=>(t(!0),s(k,null,O(d(u),(_,y)=>(t(),s("div",{key:y},["route"in _?(t(),g(x,{key:d(p)(_.id)||_.name,to:_.route,class:"pb-1 pt-1 mb-2"},{default:c(()=>[j("div",{innerHTML:d(p)(_.id)||_.name},null,8,ne)]),_:2},1032,["to"])):$("",!0)]))),128))}},re=A({__name:"DataSection",props:["parentObject","items","itemType"],setup(a){const{parentObject:r,items:n,itemType:m}=a,o=b(()=>Array.isArray(n)&&n.length===1?m.replace("-"," "):I(m)),u=B([o.value]);return(p,e)=>(t(),g(P,{opened:u.value,"onUpdate:opened":e[0]||(e[0]=l=>u.value=l)},{default:c(()=>[i(F,{value:o.value},{activator:c(({props:l})=>[i(N,{"no-gutters":""},{default:c(()=>[i(w,{cols:"auto"},{default:c(()=>[i(x,M({class:"text-capitalize text-h5"},l),{default:c(()=>[h(v(o.value),1)]),_:2},1040)]),_:2},1024)]),_:2},1024)]),default:c(()=>["columnNames"in a.items[0]&&a.items[0]["object-type"]!="case-study"?(t(),g(Q,{key:0,class:"mx-8",items:a.items},null,8,["items"])):(t(),g(se,{key:1,"parent-object":a.parentObject,items:a.items,"item-type":a.itemType},null,8,["parent-object","items","item-type"]))]),_:1},8,["value"])]),_:1},8,["opened"]))}}),le={__name:"Tag",props:["tags"],setup(a){const r=B([]);n();async function n(){try{r.value=await E()}catch(o){console.error("Failed to fetch descriptions:",o),r.value=[]}}function m(o){if(!r.value.length)return"";const u=r.value.find(p=>p.name===o);return u?u.description:"Definition not found"}return(o,u)=>(t(),s("span",null,[(t(!0),s(k,null,O(a.tags,(p,e)=>(t(),g(X,{key:e,text:m(p),location:"top"},{activator:c(({props:l})=>[i(W,M({class:"ma-1",density:"compact",variant:"outlined",label:""},l),{default:c(()=>[h(v(p),1)]),_:2},1040)]),_:2},1032,["text"]))),128))]))}},oe={key:0,class:"font-weight-bold"},ie=["href"],ce={key:2},ue={key:3},de={key:0},me={key:0},pe={key:1},fe={key:4},_e=3,be=A({__name:"DataSidebarEntry",props:["objectType","relatedObjs"],setup(a){const{objectType:r,relatedObjs:n}=a;let m=b(()=>r==="ATT&CK-reference"||e.value||l.value||_.value),o=b(()=>l.value&&n.length<=_e),u=b(()=>{const f=I(r),T=L(f," ");return l.value&&!o.value?`Number of ${T}`:l.value&&n.length>1?T:L(r,"-")}),p=b(()=>l.value&&!o.value?n.length:n),e=b(()=>{const f=typeof p.value;return f==="string"||f==="number"}),l=b(()=>G(n)),_=b(()=>Array.isArray(n)&&n.every(f=>typeof f=="string")),y=b(()=>r==="ATT&CK-reference"||e.value||l.value||_.value||H(n[0])&&!("use"in n[0]));return(f,T)=>{const D=z("router-link");return t(),s("div",{class:q(d(m)?"pb-4":"")},[d(y)?(t(),s("span",oe,v(d(u))+": ",1)):$("",!0),a.objectType==="ATT&CK-reference"?(t(),s("a",{key:1,href:a.relatedObjs.url,target:"_blank"},[h(v(a.relatedObjs.id)+" ",1),i(K,{"x-small":""},{default:c(()=>[h(" mdi-open-in-new ")]),_:1})],8,ie)):d(e)?(t(),s("span",ce,v(d(p)),1)):d(l)?(t(),s("span",ue,[(t(!0),s(k,null,O(d(p),(V,C)=>(t(),s("span",{key:C},[C>0?(t(),s("span",de,", ")):$("",!0),i(D,{to:V.route},{default:c(()=>["label"in V?(t(),s("span",me,v(V.label),1)):(t(),s("span",pe,v(V.name),1))]),_:2},1032,["to"])]))),128))])):d(_)?(t(),s("span",fe,[i(le,{tags:d(p).sort()},null,8,["tags"])])):$("",!0)],2)}}}),ye=j("span",{class:"font-weight-bold"},"ID:",-1),ve={class:"pb-4"},je=j("span",{class:"font-weight-bold"},"Created:",-1),he=j("span",{class:"font-weight-bold"},"Last Modified:",-1),ge=A({__name:"DataSidebar",props:["dataObject"],setup(a){function r(n){const m=new Date(n),o={year:"numeric",month:"long",day:"2-digit",timeZone:"UTC"};return new Intl.DateTimeFormat("en-GB",o).format(m)}return(n,m)=>(t(),g(ee,{flat:"",class:"mt-10"},{default:c(()=>[i(Y,{class:"text-body-2"},{default:c(()=>[j("p",null,[ye,h(" "+v(a.dataObject.id),1)]),(t(!0),s(k,null,O(a.dataObject.relatedObjects,(o,u)=>(t(),s("div",{key:u},[i(be,{"object-type":u,"related-objs":o},null,8,["object-type","related-objs"])]))),128)),j("div",ve,[je,h(" "+v(r(a.dataObject.created_date)),1)]),j("div",null,[he,h(" "+v(r(a.dataObject.modified_date)),1)])]),_:1})]),_:1}))}}),Te={key:0},Oe=["innerHTML"],ke={key:1},Ie={__name:"IDView",setup(a){const{mdAndUp:r}=R(),n=new U,m=S(),o=J(),{id:u,objectTypePlural:p}=o.params,e=b(()=>{const y=m.getDataObjectById(u);if(!(!y||y["object-type"]!==Z(p)))return m.getDataObjectById(u)}),l=b(()=>{let y={};return e.value&&e.value.relatedObjects&&Object.keys(e.value.relatedObjects).forEach(f=>{Array.isArray(e.value.relatedObjects[f])&&typeof e.value.relatedObjects[f][0]!="string"&&(y[f]=e.value.relatedObjects[f])}),y}),_=b(()=>e.value&&"subtechnique-of"in e.value?`${m.getParent(e.value).name}: ${e.value.name}`:e.value?e.value.name:"No Title Found");return(y,f)=>e.value!=null?(t(),s("div",Te,[i(te,{pageTitle:_.value},null,8,["pageTitle"]),i(N,null,{default:c(()=>[i(w,{cols:d(r)?9:12},{default:c(()=>[i(x,{class:"text-h5"},{default:c(()=>[h(" Summary ")]),_:1}),i(x,null,{default:c(()=>[j("div",{class:q(`${d(r)?"pa-3":""}`),innerHTML:d(n).render(e.value.description)},null,10,Oe)]),_:1})]),_:1},8,["cols"]),i(w,{cols:d(r)?3:12},{default:c(()=>[i(ge,{"data-object":e.value},null,8,["data-object"])]),_:1},8,["cols"])]),_:1}),(t(!0),s(k,null,O(l.value,(T,D)=>(t(),g(re,{key:D,itemType:D,items:T,parentObject:e.value},null,8,["itemType","items","parentObject"]))),128))])):(t(),s("div",ke,[i(ae)]))}};export{Ie as default};
