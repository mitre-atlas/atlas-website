import{u as S,q as s,o as t,s as O,c as g,a as $,w as i,b as j,t as u,E as x,F as k,al as A,f as _,am as I,r as B,G as F,g as o,I as P,h as N,i as w,J as M,d as h,v,an as E,ao as L,ap as G,aq as H,ar as K,n as q,L as z,e as R,as as U,ag as J,at as Z}from"./index-p9DeK3oM.js";import{_ as Q}from"./InfoTable-DtfKJZis.js";import{V as W}from"./VChip-D4Navkp1.js";import{V as X}from"./VTooltip-DJb6Qa0U.js";import{b as Y,V as ee}from"./VCard-CvxCcJbN.js";import{_ as te}from"./PageSectionTitle.vue_vue_type_script_setup_true_lang-DuHzWsQq.js";import{_ as ae}from"./ErrorNotFoundView.vue_vue_type_script_setup_true_lang-Beg72kEb.js";import"./filter-CfCUpQGL.js";import"./VDataTable-CTB4x0cn.js";const ne=["innerHTML"],se={__name:"RelatedObjsList",props:["parentObject","items","itemType"],setup(a){const f=S(),{parentObject:n,items:d,itemType:m}=a,l=[d][0].sort((e,r)=>e.id>r.id?1:-1);let c=e=>f.getDataObjectById(e).label;return(e,r)=>(t(!0),s(k,null,O(u(l),(p,y)=>(t(),s("div",{key:y},["route"in p?(t(),g(x,{key:u(c)(p.id)||p.name,to:p.route,class:"pb-1 pt-1 mb-2"},{default:i(()=>[j("div",{innerHTML:u(c)(p.id)||p.name},null,8,ne)]),_:2},1032,["to"])):$("",!0)]))),128))}},re=A({__name:"DataSection",props:["parentObject","items","itemType"],setup(a){const{parentObject:f,items:n,itemType:d}=a,m=_(()=>Array.isArray(n)&&n.length===1?d.replace("-"," "):I(d)),l=B([m.value]);return(c,e)=>(t(),g(F,{opened:l.value,"onUpdate:opened":e[0]||(e[0]=r=>l.value=r)},{default:i(()=>[o(P,{value:m.value},{activator:i(({props:r})=>[o(N,{"no-gutters":""},{default:i(()=>[o(w,{cols:"auto"},{default:i(()=>[o(x,M({class:"text-capitalize text-h5"},r),{default:i(()=>[h(v(m.value),1)]),_:2},1040)]),_:2},1024)]),_:2},1024)]),default:i(()=>["columnNames"in a.items[0]&&a.items[0]["object-type"]!="case-study"?(t(),g(Q,{key:0,class:"mx-8",items:a.items},null,8,["items"])):(t(),g(se,{key:1,"parent-object":a.parentObject,items:a.items,"item-type":a.itemType},null,8,["parent-object","items","item-type"]))]),_:1},8,["value"])]),_:1},8,["opened"]))}}),le={__name:"Tag",props:["tags"],setup(a){const{tags:f}=a,n=B([]);d();async function d(){try{n.value=await E()}catch(l){console.error("Failed to fetch descriptions:",l),n.value=[]}}function m(l){if(!n.value.length)return"";const c=n.value.find(e=>e.name===l);return c?c.description:"Definition not found"}return(l,c)=>(t(),s("span",null,[(t(!0),s(k,null,O(a.tags,(e,r)=>(t(),g(X,{key:r,text:m(e),location:"top"},{activator:i(({props:p})=>[o(W,M({class:"ma-1",density:"compact",variant:"outlined",label:""},p),{default:i(()=>[h(v(e),1)]),_:2},1040)]),_:2},1032,["text"]))),128))]))}},oe={key:0,class:"font-weight-bold"},ie=["href"],ce={key:2},ue={key:3},de={key:0},me={key:0},pe={key:1},fe={key:4},be=3,_e=A({__name:"DataSidebarEntry",props:["objectType","relatedObjs"],setup(a){const{objectType:f,relatedObjs:n}=a;let d=_(()=>f==="ATT&CK-reference"||e.value||r.value||p.value),m=_(()=>r.value&&n.length<=be),l=_(()=>{const b=I(f),T=L(b," ");return r.value&&!m.value?`Number of ${T}`:r.value&&n.length>1?T:L(f,"-")}),c=_(()=>r.value&&!m.value?n.length:n),e=_(()=>{const b=typeof c.value;return b==="string"||b==="number"}),r=_(()=>G(n)),p=_(()=>Array.isArray(n)&&n.every(b=>typeof b=="string")),y=_(()=>f==="ATT&CK-reference"||e.value||r.value||p.value||H(n[0])&&!("use"in n[0]));return(b,T)=>{const D=K("router-link");return t(),s("div",{class:q(u(d)?"pb-4":"")},[u(y)?(t(),s("span",oe,v(u(l))+": ",1)):$("",!0),a.objectType==="ATT&CK-reference"?(t(),s("a",{key:1,href:a.relatedObjs.url,target:"_blank"},[h(v(a.relatedObjs.id)+" ",1),o(z,{"x-small":""},{default:i(()=>[h(" mdi-open-in-new ")]),_:1})],8,ie)):u(e)?(t(),s("span",ce,v(u(c)),1)):u(r)?(t(),s("span",ue,[(t(!0),s(k,null,O(u(c),(V,C)=>(t(),s("span",{key:C},[C>0?(t(),s("span",de,", ")):$("",!0),o(D,{to:V.route},{default:i(()=>["label"in V?(t(),s("span",me,v(V.label),1)):(t(),s("span",pe,v(V.name),1))]),_:2},1032,["to"])]))),128))])):u(p)?(t(),s("span",fe,[o(le,{tags:u(c).sort()},null,8,["tags"])])):$("",!0)],2)}}}),ye=j("span",{class:"font-weight-bold"},"ID:",-1),ve={class:"pb-4"},je=j("span",{class:"font-weight-bold"},"Created:",-1),he=j("span",{class:"font-weight-bold"},"Last Modified:",-1),ge=A({__name:"DataSidebar",props:["dataObject"],setup(a){const{dataObject:f}=a;function n(d){const m=new Date(d),l={year:"numeric",month:"long",day:"2-digit",timeZone:"UTC"};return new Intl.DateTimeFormat("en-GB",l).format(m)}return(d,m)=>(t(),g(ee,{flat:"",class:"mt-10"},{default:i(()=>[o(Y,{class:"text-body-2"},{default:i(()=>[j("p",null,[ye,h(" "+v(a.dataObject.id),1)]),(t(!0),s(k,null,O(a.dataObject.relatedObjects,(l,c)=>(t(),s("div",{key:c},[o(_e,{"object-type":c,"related-objs":l},null,8,["object-type","related-objs"])]))),128)),j("div",ve,[je,h(" "+v(n(a.dataObject.created_date)),1)]),j("div",null,[he,h(" "+v(n(a.dataObject.modified_date)),1)])]),_:1})]),_:1}))}}),Te={key:0},Oe=["innerHTML"],ke={key:1},Ie={__name:"IDView",setup(a){const{mdAndUp:f}=R(),n=new U,d=S(),m=J(),{id:l,objectTypePlural:c}=m.params,e=_(()=>{const y=d.getDataObjectById(l);if(!(!y||y["object-type"]!==Z(c)))return d.getDataObjectById(l)}),r=_(()=>{let y={};return e.value&&e.value.relatedObjects&&Object.keys(e.value.relatedObjects).forEach(b=>{Array.isArray(e.value.relatedObjects[b])&&typeof e.value.relatedObjects[b][0]!="string"&&(y[b]=e.value.relatedObjects[b])}),y}),p=_(()=>e.value&&"subtechnique-of"in e.value?`${d.getParent(e.value).name}: ${e.value.name}`:e.value?e.value.name:"No Title Found");return(y,b)=>e.value!=null?(t(),s("div",Te,[o(te,{pageTitle:p.value},null,8,["pageTitle"]),o(N,null,{default:i(()=>[o(w,{cols:u(f)?9:12},{default:i(()=>[o(x,{class:"text-h5"},{default:i(()=>[h(" Summary ")]),_:1}),o(x,null,{default:i(()=>[j("div",{class:q(`${u(f)?"pa-3":""}`),innerHTML:u(n).render(e.value.description)},null,10,Oe)]),_:1})]),_:1},8,["cols"]),o(w,{cols:u(f)?3:12},{default:i(()=>[o(ge,{"data-object":e.value},null,8,["data-object"])]),_:1},8,["cols"])]),_:1}),(t(!0),s(k,null,O(r.value,(T,D)=>(t(),g(re,{key:D,itemType:D,items:T,parentObject:e.value},null,8,["itemType","items","parentObject"]))),128))])):(t(),s("div",ke,[o(ae)]))}};export{Ie as default};
