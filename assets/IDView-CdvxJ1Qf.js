import{u as B,q as r,o as t,s as O,c as j,a as V,w as o,b as h,t as m,E as w,F as k,al as S,f,am as N,r as q,G,g as l,I as H,h as M,i as A,J as z,d as T,v,an as K,ao as L,ap as R,aq as U,ar as J,n as P,L as Z,x as Q,y as W,e as X,as as Y,ag as ee,at as te}from"./index-DP1IgBSD.js";import{_ as ae}from"./InfoTable-Xo-GZPKt.js";import{V as ne}from"./VChip-CQJ2_rm0.js";import{V as F}from"./VTooltip-CVVcF8ZD.js";import{b as se,V as re}from"./VCard-D1ingQcL.js";import{_ as oe}from"./PageSectionTitle.vue_vue_type_script_setup_true_lang-McPhvpzo.js";import{_ as ie}from"./ErrorNotFoundView.vue_vue_type_script_setup_true_lang-gH-yMVZS.js";import"./filter-C_t_CJmW.js";import"./VInput-BUWZnAbt.js";import"./VDataTable-BbBJZyrK.js";const le=["innerHTML"],ue={__name:"RelatedObjsList",props:["parentObject","items","itemType"],setup(a){const b=B(),{parentObject:n,items:p,itemType:i}=a,u=[p][0].sort((e,c)=>e.id>c.id?1:-1);let s=e=>b.getDataObjectById(e).label;return(e,c)=>(t(!0),r(k,null,O(m(u),(_,d)=>(t(),r("div",{key:d},["route"in _?(t(),j(w,{key:m(s)(_.id)||_.name,to:_.route,class:"pb-1 pt-1 mb-2"},{default:o(()=>[h("div",{innerHTML:m(s)(_.id)||_.name},null,8,le)]),_:2},1032,["to"])):V("",!0)]))),128))}},ce=S({__name:"DataSection",props:["parentObject","items","itemType"],setup(a){const{parentObject:b,items:n,itemType:p}=a,i=f(()=>Array.isArray(n)&&n.length===1?p.replace("-"," "):N(p)),u=q([i.value]);return(s,e)=>(t(),j(G,{opened:u.value,"onUpdate:opened":e[0]||(e[0]=c=>u.value=c)},{default:o(()=>[l(H,{value:i.value},{activator:o(({props:c})=>[l(M,{"no-gutters":""},{default:o(()=>[l(A,{cols:"auto"},{default:o(()=>[l(w,z({class:"text-capitalize text-h5"},c),{default:o(()=>[T(v(i.value),1)]),_:2},1040)]),_:2},1024)]),_:2},1024)]),default:o(()=>["columnNames"in a.items[0]&&a.items[0]["object-type"]!="case-study"?(t(),j(ae,{key:0,class:"mx-8",items:a.items},null,8,["items"])):(t(),j(ue,{key:1,"parent-object":a.parentObject,items:a.items,"item-type":a.itemType},null,8,["parent-object","items","item-type"]))]),_:1},8,["value"])]),_:1},8,["opened"]))}}),de={__name:"Tag",props:["tags"],setup(a){const{tags:b}=a,n=q([]);p();async function p(){try{n.value=await K()}catch(u){console.error("Failed to fetch descriptions:",u),n.value=[]}}function i(u){if(!n.value.length)return"";const s=n.value.find(e=>e.name===u);return s?s.description:"Definition not found"}return(u,s)=>(t(),r("span",null,[(t(!0),r(k,null,O(a.tags,(e,c)=>(t(),j(F,{key:c,text:i(e),location:"top"},{activator:o(({props:_})=>[l(ne,z({class:"ma-1",density:"compact",variant:"outlined",label:""},_),{default:o(()=>[T(v(e),1)]),_:2},1040)]),_:2},1032,["text"]))),128))]))}},me={key:0,class:"font-weight-bold"},pe=["href"],fe={key:2},be={key:3},_e={key:4},ye={key:0},ve={key:0},he={key:1},ge={key:5},je=3,I=S({__name:"DataSidebarEntry",props:["objectType","relatedObjs"],setup(a){const{objectType:b,relatedObjs:n}=a;let p=f(()=>b==="ATT&CK-reference"||e.value||c.value||d.value||g.value),i=f(()=>d.value&&n.length<=je),u=f(()=>{const y=N(b),$=L(y," ");return d.value&&!i.value?`Number of ${$}`:d.value&&n.length>1?$:L(b,"-")});const s=f(()=>d.value&&!i.value?n.length:n);let e=f(()=>typeof s.value==="number"),c=f(()=>typeof s.value==="string"),_=f(()=>{const y=s.value;return y.charAt(0).toUpperCase()+y.slice(1)}),d=f(()=>R(n)),g=f(()=>Array.isArray(n)&&n.every(y=>typeof y=="string")),D=f(()=>b==="ATT&CK-reference"||e.value||c.value||d.value||g.value||U(n[0])&&!("use"in n[0]));return(y,$)=>{const E=J("router-link");return t(),r("div",{class:P(m(p)?"pb-4":"")},[m(D)?(t(),r("span",me,v(m(u))+": ",1)):V("",!0),a.objectType==="ATT&CK-reference"?(t(),r("a",{key:1,href:a.relatedObjs.url,target:"_blank"},[T(v(a.relatedObjs.id)+" ",1),l(Z,{"x-small":""},{default:o(()=>[T(" mdi-open-in-new ")]),_:1})],8,pe)):m(e)?(t(),r("span",fe,v(s.value),1)):m(c)?(t(),r("span",be,v(m(_)),1)):m(d)?(t(),r("span",_e,[(t(!0),r(k,null,O(s.value,(x,C)=>(t(),r("span",{key:C},[C>0?(t(),r("span",ye,", ")):V("",!0),l(E,{to:x.route},{default:o(()=>["label"in x?(t(),r("span",ve,v(x.label),1)):(t(),r("span",he,v(x.name),1))]),_:2},1032,["to"])]))),128))])):m(g)?(t(),r("span",ge,[l(de,{tags:s.value.sort()},null,8,["tags"])])):V("",!0)],2)}}}),Te=h("span",{class:"font-weight-bold"},"ID:",-1),Oe={class:"pb-4"},ke=h("span",{class:"font-weight-bold"},"Created:",-1),xe=h("span",{class:"font-weight-bold"},"Last Modified:",-1),Ve=S({__name:"DataSidebar",props:["dataObject"],setup(a){const{dataObject:b}=a;function n(i){const u=new Date(i),s={year:"numeric",month:"long",day:"2-digit",timeZone:"UTC"};return new Intl.DateTimeFormat("en-GB",s).format(u)}function p(i){return i==="feasible"?"The technique has been shown to work in a research or academic setting":i==="demonstrated"?"The technique has been shown to be effective in a red team exercise or demonstration on a realistic AI-enabled system.":i==="realized"?"The technique has been used by a threat actor in a real-world incident targeting an AI-enabled systems.":""}return(i,u)=>(t(),j(re,{flat:"",class:"mt-10"},{default:o(()=>[l(se,{class:"text-body-2"},{default:o(()=>[h("p",null,[Te,T(" "+v(a.dataObject.id),1)]),(t(!0),r(k,null,O(a.dataObject.relatedObjects,(s,e)=>(t(),r("div",{key:e},[String(e)==="maturity"?(t(),j(F,{key:0,bottom:""},{activator:o(({props:c})=>[h("span",Q(W(c)),[l(I,{"object-type":e,"related-objs":s},null,8,["object-type","related-objs"])],16)]),default:o(()=>[h("span",null,v(p(s)),1)]),_:2},1024)):(t(),j(I,{key:1,"object-type":e,"related-objs":s},null,8,["object-type","related-objs"]))]))),128)),h("div",Oe,[ke,T(" "+v(n(a.dataObject.created_date)),1)]),h("div",null,[xe,T(" "+v(n(a.dataObject.modified_date)),1)])]),_:1})]),_:1}))}}),we={key:0},De=["innerHTML"],$e={key:1},Pe={__name:"IDView",setup(a){const{mdAndUp:b}=X(),n=new Y,p=B(),i=ee(),{id:u,objectTypePlural:s}=i.params,e=f(()=>{const d=p.getDataObjectById(u);if(!(!d||d["object-type"]!==te(s)))return p.getDataObjectById(u)}),c=f(()=>{let d={};return e.value&&e.value.relatedObjects&&Object.keys(e.value.relatedObjects).forEach(g=>{Array.isArray(e.value.relatedObjects[g])&&typeof e.value.relatedObjects[g][0]!="string"&&(d[g]=e.value.relatedObjects[g])}),d}),_=f(()=>e.value&&"subtechnique-of"in e.value?`${p.getParent(e.value).name}: ${e.value.name}`:e.value?e.value.name:"No Title Found");return(d,g)=>e.value!=null?(t(),r("div",we,[l(oe,{pageTitle:_.value},null,8,["pageTitle"]),l(M,null,{default:o(()=>[l(A,{cols:m(b)?9:12},{default:o(()=>[l(w,{class:"text-h5"},{default:o(()=>[T(" Summary ")]),_:1}),l(w,null,{default:o(()=>[h("div",{class:P(`${m(b)?"pa-3":""}`),innerHTML:m(n).render(e.value.description)},null,10,De)]),_:1})]),_:1},8,["cols"]),l(A,{cols:m(b)?3:12},{default:o(()=>[l(Ve,{"data-object":e.value},null,8,["data-object"])]),_:1},8,["cols"])]),_:1}),(t(!0),r(k,null,O(c.value,(D,y)=>(t(),j(ce,{key:y,itemType:y,items:D,parentObject:e.value},null,8,["itemType","items","parentObject"]))),128))])):(t(),r("div",$e,[l(ie)]))}};export{Pe as default};
