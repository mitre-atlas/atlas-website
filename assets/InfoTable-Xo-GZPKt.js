import{c as f,a as T,o as n,w as t,b as F,g as l,L as U,J as j,d as b,f as g,D as E,r as N,an as q,t as i,e as I,z as J,ag as G,ak as O,ar as Q,q as w,i as M,h as K,au as W,j as X,M as Y,s as Z,v as D}from"./index-DP1IgBSD.js";import{V as ee}from"./VTooltip-CVVcF8ZD.js";import{V as te,a as $}from"./filter-C_t_CJmW.js";import{V as ae}from"./VDataTable-BbBJZyrK.js";const se=F("span",null,[F("span",{class:"attack-and"},"&"),b(" indicates an adaptation from ATT&CK ")],-1),le={__name:"AttackIconToolTip",props:["items"],setup(p){const{items:_}=p;return(y,L)=>p.items.some(v=>"ATT&CK-reference"in v)?(n(),f(ee,{key:0},{activator:t(({props:v})=>[l(U,j({size:"small"},v),{default:t(()=>[b(" mdi-information-outline ")]),_:2},1040)]),default:t(()=>[se]),_:1})):T("",!0)}},z={__name:"TableFilter",props:["categories","stages"],emits:["updateFilters"],setup(p,{emit:_}){const{categories:y,stages:L}=p,v=_,x=g(()=>y?"category":"ML-lifecycle");let o=E(y||L);const c=N([]);function B(){v("updateFilters",x.value,c.value)}const h=N([]);C();async function C(){try{h.value=await q();const u=h.value.map(d=>d.name);o.sort((d,V)=>u.indexOf(d)-u.indexOf(V))}catch(u){console.error("Failed to fetch descriptions:",u),h.value=[]}}return(u,d)=>(n(),f(te,{modelValue:c.value,"onUpdate:modelValue":[d[0]||(d[0]=V=>c.value=V),B],clearable:"",chips:"",label:`Filter by ${x.value==="category"?"category":"ML lifecycle stage"}`,items:i(o),multiple:""},null,8,["modelValue","label","items"]))}},ne={key:0},oe={key:1},re={key:0,class:"attack-and"},ie=["innerHTML"],fe={__name:"InfoTable",props:["items"],setup(p){const{smAndDown:_}=I(),{mdAndUp:y}=I(),L=J("markdownit"),v=G();let{objectTypePlural:x}=v.params;const{items:o}=p,c=E({category:[],"ML-lifecycle":[]}),B=g(()=>c.category.length===0&&c["ML-lifecycle"].length===0?o:o.filter(e=>c.category.every(a=>e.category.includes(a))&&c["ML-lifecycle"].every(a=>e["ML-lifecycle"].includes(a))));function h(e,a){c[e]=a}const C=g(()=>o.reduce((e,a)=>("category"in a&&a.category.forEach(r=>{e.includes(r)||e.push(r)}),e),[])),u=g(()=>o.reduce((e,a)=>("ML-lifecycle"in a&&a["ML-lifecycle"].forEach(r=>{e.includes(r)||e.push(r)}),e),[])),d=g(()=>{let e=[{title:"ID",key:"id",align:y.value?"end":" d-none"},{title:"Name",key:"name",align:"start"}];const a=V.value.map(r=>({value:r,title:O(r),sortable:!1}));return e.concat(a)}),V=g(()=>"columnNames"in o[0]?o[0].columnNames:["description"]),k=N(""),A=g(()=>o[0].columnNames?o[0].columnNames[0]!=="use":!0);let S=N(!1);function H(){S.value=!S.value,k.value=""}function P(e){return e.length>150?e.substring(0,150)+"...":e}return(e,a)=>{const r=Q("router-link");return n(),w("div",null,[l(K,{class:"mb-3"},{default:t(()=>[l(M,{cols:i(_)?12:""},{default:t(()=>[A.value?(n(),f($,{key:0,modelValue:k.value,"onUpdate:modelValue":a[0]||(a[0]=s=>k.value=s),label:"Search for Keywords","append-inner-icon":"mdi-magnify","hide-details":""},null,8,["modelValue"])):(n(),f(K,{key:1,"no-gutters":""},{default:t(()=>[l(W),l(M,null,{default:t(()=>[i(S)?(n(),f($,{key:0,modelValue:k.value,"onUpdate:modelValue":a[1]||(a[1]=s=>k.value=s),density:"compact",label:"Search for Keywords"},null,8,["modelValue"])):T("",!0)]),_:1}),l(M,{sm:"1"},{default:t(()=>[l(X,{variant:i(S)===!1?"outlined":"text",onClick:H},{default:t(()=>[l(U,null,{default:t(()=>[b("mdi-magnify")]),_:1}),b(" Search ")]),_:1},8,["variant"])]),_:1})]),_:1}))]),_:1},8,["cols"]),C.value.length>0?(n(),f(M,{key:0,cols:i(_)?6:""},{default:t(()=>[l(z,{categories:C.value,onUpdateFilters:h},null,8,["categories"])]),_:1},8,["cols"])):T("",!0),u.value.length>0?(n(),f(M,{key:1,cols:i(_)?6:""},{default:t(()=>[l(z,{stages:u.value,onUpdateFilters:h},null,8,["stages"])]),_:1},8,["cols"])):T("",!0)]),_:1}),l(ae,{items:B.value,headers:d.value,sortBy:i(x)==="studies"?[{key:"id",order:"desc"}]:[],search:k.value,"items-per-page":"-1"},Y({"header.name":t(({column:s,isSorted:m,getSortIcon:R})=>[F("span",null,[b(D(s.title)+" ",1),l(le,{items:p.items},null,8,["items"])]),m(s)?(n(),f(U,{key:0,icon:R(s)},null,8,["icon"])):T("",!0)]),"item.id":t(({item:s,value:m})=>[l(r,{to:s.route,class:"pl-5"},{default:t(()=>[b(D(m),1)]),_:2},1032,["to"])]),"item.name":t(({item:s,value:m})=>[l(r,{to:s.route},{default:t(()=>["label"in s?(n(),w("div",ne,D(s.label),1)):(n(),w("div",oe,D(m),1))]),_:2},1032,["to"]),"ATT&CK-reference"in s?(n(),w("span",re,"&")):T("",!0)]),bottom:t(()=>[]),_:2},[Z(V.value,s=>({name:`item.${s}`,fn:t(({value:m})=>[F("div",{class:"pt-5 pb-5",innerHTML:i(y)?i(L).render(m):i(L).render(P(m))},null,8,ie)])}))]),1032,["items","headers","sortBy","search"])])}}};export{fe as _};
