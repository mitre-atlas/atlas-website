import{q as S,o as t,l as s,r as O,a as h,w as l,e as V,m,E as x,x as k,F as T,al as w,c as b,am as C,y as I,b as r,V as B,d as D,I as N,g,t as v,J as M,G as q,an as P,ao as L,ap as E,aq as F,L as H,ar as z,u as G,as as K,ag as R,at as J,n as U}from"./index-C1sC5M5c.js";import{_ as Q}from"./InfoTable-CbtUE-Ki.js";import{V as W}from"./VChip-CII92waj.js";import{V as X}from"./VTooltip-DO69Uidt.js";import{b as Y,V as Z}from"./VCard-Bm-IPP_r.js";import{_ as ee}from"./PageSectionTitle.vue_vue_type_script_setup_true_lang-DOfblOoM.js";import{_ as te}from"./ErrorNotFoundView.vue_vue_type_script_setup_true_lang-DvUHo1lx.js";import"./filter-BUbwDi4z.js";import"./VDataTable-CxAJXaqV.js";const ae=["innerHTML"],se={__name:"RelatedObjsList",props:["parentObject","items","itemType"],setup(a){const i=S(),{parentObject:n,items:d,itemType:c}=a,u=[d][0].sort((e,p)=>e.id>p.id?1:-1);let _=e=>i.getDataObjectById(e).label;return(e,p)=>(t(!0),s(T,null,O(m(u),(f,o)=>(t(),s("div",{key:o},["route"in f?(t(),h(x,{key:m(_)(f.id)||f.name,to:f.route,class:"pb-1 pt-1 mb-2"},{default:l(()=>[V("div",{innerHTML:m(_)(f.id)||f.name},null,8,ae)]),_:2},1032,["to"])):k("",!0)]))),128))}},ne=w({__name:"DataSection",props:["parentObject","items","itemType"],setup(a){const{parentObject:i,items:n,itemType:d}=a,c=b(()=>Array.isArray(n)&&n.length===1?d.replace("-"," "):C(d)),u=I([c.value]);return(_,e)=>(t(),h(q,{opened:u.value,"onUpdate:opened":e[0]||(e[0]=p=>u.value=p)},{default:l(()=>[r(M,{value:c.value},{activator:l(({props:p})=>[r(B,{"no-gutters":""},{default:l(()=>[r(D,{cols:"auto"},{default:l(()=>[r(x,N({class:"text-capitalize text-h5"},p),{default:l(()=>[g(v(c.value),1)]),_:2},1040)]),_:2},1024)]),_:2},1024)]),default:l(()=>["columnNames"in a.items[0]&&a.items[0]["object-type"]!="case-study"?(t(),h(Q,{key:0,class:"mx-8",items:a.items},null,8,["items"])):(t(),h(se,{key:1,"parent-object":a.parentObject,items:a.items,"item-type":a.itemType},null,8,["parent-object","items","item-type"]))]),_:1},8,["value"])]),_:1},8,["opened"]))}}),re={__name:"Tag",props:["tags"],setup(a){const i=I([]);n();async function n(){try{i.value=await P()}catch(c){console.error("Failed to fetch descriptions:",c),i.value=[]}}function d(c){if(!i.value.length)return"";const u=i.value.find(_=>_.name===c);return u?u.description:"Definition not found"}return(c,u)=>(t(),s("span",null,[(t(!0),s(T,null,O(a.tags,(_,e)=>(t(),h(X,{key:e,text:d(_),location:"top"},{activator:l(({props:p})=>[r(W,N({class:"ma-1",density:"compact",variant:"outlined",label:""},p),{default:l(()=>[g(v(_),1)]),_:2},1040)]),_:2},1032,["text"]))),128))]))}},le={class:"pb-2"},oe={key:0,class:"font-weight-bold"},ie=["href"],ce={key:2},ue={key:3},de={key:0},me={key:0},pe={key:1},_e={key:4},be=3,fe=w({__name:"DataSidebarEntry",props:["objectType","relatedObjs"],setup(a){const{objectType:i,relatedObjs:n}=a;let d=b(()=>e.value&&n.length<=be),c=b(()=>{const o=C(i),y=L(o," ");return e.value&&!d.value?`Number of ${y}`:e.value&&n.length>1?y:L(i,"-")}),u=b(()=>e.value&&!d.value?n.length:n),_=b(()=>{const o=typeof u.value;return o==="string"||o==="number"}),e=b(()=>E(n)),p=b(()=>Array.isArray(n)&&n.every(o=>typeof o=="string")),f=b(()=>i==="ATT&CK-reference"||_.value||e.value||p.value||F(n[0])&&!("use"in n[0]));return(o,y)=>{const $=z("router-link");return t(),s("div",le,[m(f)?(t(),s("span",oe,v(m(c))+": ",1)):k("",!0),a.objectType==="ATT&CK-reference"?(t(),s("a",{key:1,href:a.relatedObjs.url,target:"_blank"},[g(v(a.relatedObjs.id)+" ",1),r(H,{"x-small":""},{default:l(()=>[g(" mdi-open-in-new ")]),_:1})],8,ie)):m(_)?(t(),s("span",ce,v(m(u)),1)):m(e)?(t(),s("span",ue,[(t(!0),s(T,null,O(m(u),(j,A)=>(t(),s("span",{key:A},[A>0?(t(),s("span",de,", ")):k("",!0),r($,{to:j.route},{default:l(()=>["label"in j?(t(),s("span",me,v(j.label),1)):(t(),s("span",pe,v(j.name),1))]),_:2},1032,["to"])]))),128))])):m(p)?(t(),s("span",_e,[r(re,{tags:m(u).sort()},null,8,["tags"])])):k("",!0)])}}}),ye={class:"pb-2"},ve=V("span",{class:"font-weight-bold"},"ID:",-1),je=w({__name:"DataSidebar",props:["dataObject"],setup(a){return(i,n)=>(t(),h(Z,{flat:"",class:"mt-10"},{default:l(()=>[r(Y,{class:"text-body-2"},{default:l(()=>[V("p",ye,[ve,g(" "+v(a.dataObject.id),1)]),(t(!0),s(T,null,O(a.dataObject.relatedObjects,(d,c)=>(t(),s("p",{key:c},[r(fe,{"object-type":c,"related-objs":d},null,8,["object-type","related-objs"])]))),128))]),_:1})]),_:1}))}}),he={key:0},ge=["innerHTML"],Oe={key:1},Se={__name:"IDView",setup(a){const{mdAndUp:i}=G(),n=new K,d=S(),c=R(),{id:u,objectTypePlural:_}=c.params,e=b(()=>{const o=d.getDataObjectById(u);if(!(!o||o["object-type"]!==J(_)))return d.getDataObjectById(u)}),p=b(()=>{let o={};return e.value&&e.value.relatedObjects&&Object.keys(e.value.relatedObjects).forEach(y=>{Array.isArray(e.value.relatedObjects[y])&&typeof e.value.relatedObjects[y][0]!="string"&&(o[y]=e.value.relatedObjects[y])}),o}),f=b(()=>e.value&&"subtechnique-of"in e.value?`${d.getParent(e.value).name}: ${e.value.name}`:e.value?e.value.name:"No Title Found");return(o,y)=>e.value!=null?(t(),s("div",he,[r(ee,{pageTitle:f.value},null,8,["pageTitle"]),r(B,null,{default:l(()=>[r(D,{cols:m(i)?9:12},{default:l(()=>[r(x,{class:"text-h5"},{default:l(()=>[g(" Summary ")]),_:1}),r(x,null,{default:l(()=>[V("div",{class:U(`${m(i)?"pa-3":""}`),innerHTML:m(n).render(e.value.description)},null,10,ge)]),_:1})]),_:1},8,["cols"]),r(D,{cols:m(i)?3:12},{default:l(()=>[r(je,{"data-object":e.value},null,8,["data-object"])]),_:1},8,["cols"])]),_:1}),(t(!0),s(T,null,O(p.value,($,j)=>(t(),h(ne,{key:j,itemType:j,items:$,parentObject:e.value},null,8,["itemType","items","parentObject"]))),128))])):(t(),s("div",Oe,[r(te)]))}};export{Se as default};
