import{c as f,a as T,o as n,w as t,b as N,g as l,K as I,I as P,d as b,f as _,C as j,r as D,am as R,s as i,e as K,y as G,af as J,aj as O,aq as Q,m as w,i as C,h as U,at as W,j as X,L as Y,q as Z,t as F}from"./index-CqY3JcJw.js";import{V as ee}from"./VTooltip-DSF9JUPC.js";import{V as te,a as $}from"./filter-DvVh5tGX.js";import{V as ae}from"./VDataTable-DF5gL-eZ.js";const se=N("span",null,[N("span",{class:"attack-and"},"&"),b(" indicates an adaptation from ATT&CK ")],-1),le={__name:"AttackIconToolTip",props:["items"],setup(p){const{items:g}=p;return(y,L)=>p.items.some(v=>"ATT&CK-reference"in v)?(n(),f(ee,{key:0},{activator:t(({props:v})=>[l(I,P({size:"small"},v),{default:t(()=>[b(" mdi-information-outline ")]),_:2},1040)]),default:t(()=>[se]),_:1})):T("",!0)}},E={__name:"TableFilter",props:["categories","stages"],emits:["updateFilters"],setup(p,{emit:g}){const{categories:y,stages:L}=p,v=g,x=_(()=>y?"category":"ML-lifecycle");let o=j(y||L);const c=D([]);function B(){v("updateFilters",x.value,c.value)}const h=D([]);M();async function M(){try{h.value=await R();const u=h.value.map(d=>d.name);o.sort((d,V)=>u.indexOf(d)-u.indexOf(V))}catch(u){console.error("Failed to fetch descriptions:",u),h.value=[]}}return(u,d)=>(n(),f(te,{modelValue:c.value,"onUpdate:modelValue":[d[0]||(d[0]=V=>c.value=V),B],clearable:"",chips:"",label:`Filter by ${x.value==="category"?"category":"ML lifecycle stage"}`,items:i(o),multiple:""},null,8,["modelValue","label","items"]))}},ne={key:0},oe={key:1},re={key:0,class:"attack-and"},ie=["innerHTML"],fe={__name:"InfoTable",props:["items"],setup(p){const{smAndDown:g}=K(),{mdAndUp:y}=K(),L=G("markdownit"),v=J();let{objectTypePlural:x}=v.params;const{items:o}=p,c=j({category:[],"ML-lifecycle":[]}),B=_(()=>c.category.length===0&&c["ML-lifecycle"].length===0?o:o.filter(e=>c.category.every(a=>e.category.includes(a))&&c["ML-lifecycle"].every(a=>e["ML-lifecycle"].includes(a))));function h(e,a){c[e]=a}const M=_(()=>o.reduce((e,a)=>("category"in a&&a.category.forEach(r=>{e.includes(r)||e.push(r)}),e),[])),u=_(()=>o.reduce((e,a)=>("ML-lifecycle"in a&&a["ML-lifecycle"].forEach(r=>{e.includes(r)||e.push(r)}),e),[])),d=_(()=>{let e=[{title:"ID",key:"id",align:y.value?"end":" d-none"},{title:"Name",key:"name",align:"start"}];const a=V.value.map(r=>({value:r,title:O(r),sortable:!1}));return e.concat(a)}),V=_(()=>"columnNames"in o[0]?o[0].columnNames:["description"]),k=D(""),q=_(()=>o[0].columnNames?o[0].columnNames[0]!=="use":!0);let S=D(!1);function z(){S.value=!S.value,k.value=""}function A(e){return e.length>150?e.substring(0,150)+"...":e}return(e,a)=>{const r=Q("router-link");return n(),w("div",null,[l(U,{class:"mb-3"},{default:t(()=>[l(C,{cols:i(g)?12:""},{default:t(()=>[q.value?(n(),f($,{key:0,modelValue:k.value,"onUpdate:modelValue":a[0]||(a[0]=s=>k.value=s),label:"Search for Keywords","append-inner-icon":"mdi-magnify","hide-details":""},null,8,["modelValue"])):(n(),f(U,{key:1,"no-gutters":""},{default:t(()=>[l(W),l(C,null,{default:t(()=>[i(S)?(n(),f($,{key:0,modelValue:k.value,"onUpdate:modelValue":a[1]||(a[1]=s=>k.value=s),density:"compact",label:"Search for Keywords"},null,8,["modelValue"])):T("",!0)]),_:1}),l(C,{sm:"1"},{default:t(()=>[l(X,{variant:i(S)===!1?"outlined":"text",onClick:z},{default:t(()=>[l(I,null,{default:t(()=>[b("mdi-magnify")]),_:1}),b(" Search ")]),_:1},8,["variant"])]),_:1})]),_:1}))]),_:1},8,["cols"]),M.value.length>0?(n(),f(C,{key:0,cols:i(g)?6:""},{default:t(()=>[l(E,{categories:M.value,onUpdateFilters:h},null,8,["categories"])]),_:1},8,["cols"])):T("",!0),u.value.length>0?(n(),f(C,{key:1,cols:i(g)?6:""},{default:t(()=>[l(E,{stages:u.value,onUpdateFilters:h},null,8,["stages"])]),_:1},8,["cols"])):T("",!0)]),_:1}),l(ae,{items:B.value,headers:d.value,sortBy:i(x)==="studies"?[{key:"id",order:"desc"}]:[],search:k.value,"items-per-page":"-1"},Y({"header.name":t(({column:s,isSorted:m,getSortIcon:H})=>[N("span",null,[b(F(s.title)+" ",1),l(le,{items:p.items},null,8,["items"])]),m(s)?(n(),f(I,{key:0,icon:H(s)},null,8,["icon"])):T("",!0)]),"item.id":t(({item:s,value:m})=>[l(r,{to:s.route,class:"pl-5"},{default:t(()=>[b(F(m),1)]),_:2},1032,["to"])]),"item.name":t(({item:s,value:m})=>[l(r,{to:s.route},{default:t(()=>["label"in s?(n(),w("div",ne,F(s.label),1)):(n(),w("div",oe,F(m),1))]),_:2},1032,["to"]),"ATT&CK-reference"in s?(n(),w("span",re,"&")):T("",!0)]),bottom:t(()=>[]),_:2},[Z(V.value,s=>({name:`item.${s}`,fn:t(({value:m})=>[N("div",{class:"pt-5 pb-5",innerHTML:i(y)?i(L).render(m):i(L).render(A(m))},null,8,ie)])}))]),1032,["items","headers","sortBy","search"])])}}};export{fe as _};
