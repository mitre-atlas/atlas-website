import{u as M,m as r,o as t,q as w,a as D,s as v,c as T,w as o,g as m,D as $,v as S,x as C,b as O,d as q,t as g,j as U,K as z,H as P,F as x,ak as N,f,al as R,r as F,E as G,h as H,i as I,I as K,am as J,an as E,ao as Z,ap as Q,aq as W,n as X,e as Y,ar as ee,af as te,as as ae}from"./index-DkO2sVmX.js";import{_ as ne}from"./ProcedureTimeline-CGKkxmGJ.js";import{_ as re}from"./InfoTable-DVc3rz4s.js";import{V as se}from"./VChip-Bz6tijNP.js";import{V as L}from"./VTooltip-CF_52eFU.js";import{b as ie,V as le}from"./VCard-BUcgtk6d.js";import{_ as oe}from"./PageSectionTitle.vue_vue_type_script_setup_true_lang-c3yPlm88.js";import{_ as ce}from"./ErrorNotFoundView.vue_vue_type_script_setup_true_lang-D-x2tvCr.js";import"./VTimelineItem-BKXWOhFF.js";import"./filter-CAaqlnxo.js";import"./VInput-DxGEOSyQ.js";import"./VDataTable-CLDPZdbM.js";const ue=["innerHTML"],de={__name:"RelatedObjsList",props:["parentObject","items","itemType"],setup(i){const n=M(),{parentObject:u,items:h,itemType:j}=i,y=[h][0].sort((e,d)=>e.id>d.id?1:-1);let l=e=>{const d=n.getDataObjectById(e);return d.label||d.name},a=e=>n.getDataObjectById(e);return(e,d)=>(t(!0),r(x,null,w(v(y),(c,V)=>(t(),r("div",{key:V},["route"in c?(t(),r("span",{key:v(l)(c.id)},["object-type"in c&&c["object-type"]=="case-study"?(t(),T(P,{key:0,value:v(l)(c.id)},{prepend:o(()=>[m(z,{icon:e.mdi-e.link},null,8,["icon"])]),activator:o(({props:p})=>[m($,S(C(p)),{default:o(()=>[O("div",null,[q(g(v(l)(c.id))+" ",1),m(U,{icon:"mdi-link",size:"small",to:c.route,variant:"plain",color:"blue"},null,8,["to"])])]),_:2},1040)]),default:o(()=>[m($,null,{default:o(()=>[m(ne,{study:v(a)(c.id)},null,8,["study"])]),_:2},1024)]),_:2},1032,["value"])):(t(),T($,{key:v(l)(c.id),to:c.route,class:"pb-1 pt-1 mb-2"},{default:o(()=>[O("div",{innerHTML:v(l)(c.id)},null,8,ue)]),_:2},1032,["to"]))])):D("",!0)]))),128))}},me=N({__name:"DataSection",props:["parentObject","items","itemType"],setup(i){const{parentObject:n,items:u,itemType:h}=i,j=f(()=>Array.isArray(u)&&u.length===1?h.replace("-"," ").replace("_"," "):R(h).replace("_"," ")),y=F([j.value]);return(j.value==="subtechniques"||j.value=="other subtechniques")&&(y.value=[]),(l,a)=>(t(),T(G,{opened:y.value,"onUpdate:opened":a[0]||(a[0]=e=>y.value=e)},{default:o(()=>[m(P,{value:j.value},{activator:o(({props:e})=>[m(H,{"no-gutters":""},{default:o(()=>[m(I,{cols:"auto",class:"w-100"},{default:o(()=>[m($,K({class:"text-capitalize text-h5"},e),{default:o(()=>[q(g(j.value),1)]),_:2},1040)]),_:2},1024)]),_:2},1024)]),default:o(()=>["columnNames"in i.items[0]&&i.items[0]["object-type"]!="case-study"?(t(),T(re,{key:0,class:"mx-8",items:i.items,itemType:i.itemType},null,8,["items","itemType"])):(t(),T(de,{key:1,"parent-object":i.parentObject,items:i.items,"item-type":i.itemType},null,8,["parent-object","items","item-type"]))]),_:1},8,["value"])]),_:1},8,["opened"]))}}),be={__name:"Tag",props:["tags"],setup(i){const{tags:n}=i,u=F([]);h();async function h(){try{u.value=await J()}catch(y){console.error("Failed to fetch descriptions:",y),u.value=[]}}function j(y){if(!u.value.length)return"";const l=u.value.find(a=>a.name===y);return l?l.description:"Definition not found"}return(y,l)=>(t(),r("span",null,[(t(!0),r(x,null,w(i.tags,(a,e)=>(t(),T(L,{key:e,text:j(a),location:"top"},{activator:o(({props:d})=>[m(se,K({class:"ma-1",density:"compact",variant:"outlined",label:""},d),{default:o(()=>[q(g(a),1)]),_:2},1040)]),_:2},1032,["text"]))),128))]))}},pe={key:0,class:"font-weight-bold"},fe=["href"],ve={key:2},ye={key:3},he={key:4},je={key:0},_e={key:0},ge={key:1},Oe={key:5},Te=3,A=N({__name:"DataSidebarEntry",props:["objectType","relatedObjs"],setup(i){const{objectType:n,relatedObjs:u}=i;let h=f(()=>n==="ATT&CK-reference"||a.value||e.value||c.value||V.value),j=f(()=>c.value&&u.length<=Te),y=f(()=>{const s=R(n),b=E(s," ");return c.value&&!j.value?`Number of ${b}`:c.value&&u.length>1?b:E(n,"-")});const l=f(()=>c.value&&!j.value?u.length:u);let a=f(()=>typeof l.value==="number"),e=f(()=>typeof l.value==="string"),d=f(()=>{const s=l.value;return s.charAt(0).toUpperCase()+s.slice(1)}),c=f(()=>Z(u)),V=f(()=>Array.isArray(u)&&u.every(s=>typeof s=="string")),p=f(()=>n==="ATT&CK-reference"||a.value||e.value||c.value||V.value||Q(u[0])&&!("use"in u[0]));return(s,b)=>{const k=W("router-link");return t(),r("div",{class:X(v(h)?"pb-4":"")},[v(p)?(t(),r("span",pe,g(v(y))+": ",1)):D("",!0),i.objectType==="ATT&CK-reference"?(t(),r("a",{key:1,href:i.relatedObjs.url,target:"_blank"},[q(g(i.relatedObjs.id)+" ",1),m(z,{"x-small":""},{default:o(()=>[q(" mdi-open-in-new ")]),_:1})],8,fe)):v(a)?(t(),r("span",ve,g(l.value),1)):v(e)?(t(),r("span",ye,g(v(d)),1)):v(c)?(t(),r("span",he,[(t(!0),r(x,null,w(l.value,(_,B)=>(t(),r("span",{key:B},[B>0?(t(),r("span",je,", ")):D("",!0),m(k,{to:_.route},{default:o(()=>["label"in _?(t(),r("span",_e,g(_.label),1)):(t(),r("span",ge,g(_.name),1))]),_:2},1032,["to"])]))),128))])):v(V)?(t(),r("span",Oe,[m(be,{tags:l.value.sort()},null,8,["tags"])])):D("",!0)],2)}}}),ke=O("span",{class:"font-weight-bold"},"ID:",-1),qe={key:0},xe={key:1},Ve={class:"pb-4"},we=O("span",{class:"font-weight-bold"},"Created:",-1),De=O("span",{class:"font-weight-bold"},"Last Modified:",-1),$e=N({__name:"DataSidebar",props:["dataObject"],setup(i){const{dataObject:n}=i;function u(l){const a=new Date(l),e={year:"numeric",month:"long",day:"2-digit",timeZone:"UTC"};return new Intl.DateTimeFormat("en-GB",e).format(a)}function h(l){return l==="feasible"?"The technique has been shown to work in a research or academic setting":l==="demonstrated"?"The technique has been shown to be effective in a red team exercise or demonstration on a realistic AI-enabled system.":l==="realized"?"The technique has been used by a threat actor in a real-world incident targeting an AI-enabled systems.":""}const j=()=>"mitigations"in n.relatedObjects?n.relatedObjects.mitigations.length:"mitigation"in n.relatedObjects?n.relatedObjects.mitigation.length:0;console.log(n.relatedObjects);const y=f(()=>({subtechniques:"maturity"in n.relatedObjects?n.relatedObjects.subtechniques:void 0,"subtechnique-of":"parent-technique"in n.relatedObjects?n.relatedObjects["parent-technique"]:void 0,"other-subtechniques":"other subtechniques"in n.relatedObjects?n.relatedObjects["other subtechniques"]:void 0,tactic:"tactic"in n.relatedObjects?n.relatedObjects.tactic:void 0,maturity:"maturity"in n.relatedObjects?n.relatedObjects.maturity:void 0,"number-of-case-studies":"case-study"in n.relatedObjects?n.relatedObjects["case-study"].length:0,"number-of-mitigations":j()}));return(l,a)=>(t(),T(le,{flat:"",class:"mt-10"},{default:o(()=>[m(ie,{class:"text-body-2"},{default:o(()=>[O("p",null,[ke,q(" "+g(i.dataObject.id),1)]),i.dataObject["object-type"]!="technique"?(t(),r("div",qe,[(t(!0),r(x,null,w(i.dataObject.relatedObjects,(e,d)=>(t(),r("div",{key:d},[String(d)==="maturity"?(t(),T(L,{key:0,bottom:""},{activator:o(({props:c})=>[O("span",S(C(c)),[m(A,{"object-type":d,"related-objs":e},null,8,["object-type","related-objs"])],16)]),default:o(()=>[O("span",null,g(h(e)),1)]),_:2},1024)):(t(),T(A,{key:1,"object-type":d,"related-objs":e},null,8,["object-type","related-objs"]))]))),128))])):(t(),r("div",xe,[(t(!0),r(x,null,w(y.value,(e,d)=>(t(),r("div",null,[String(d)==="maturity"?(t(),T(L,{key:0,bottom:""},{activator:o(({props:c})=>[O("span",S(C(c)),[m(A,{"object-type":d,"related-objs":e},null,8,["object-type","related-objs"])],16)]),default:o(()=>[O("span",null,g(h(e)),1)]),_:2},1024)):(t(),r(x,{key:1},[e!=null?(t(),T(A,{key:0,"object-type":d,"related-objs":e},null,8,["object-type","related-objs"])):D("",!0)],64))]))),256))])),O("div",Ve,[we,q(" "+g(u(i.dataObject.created_date)),1)]),O("div",null,[De,q(" "+g(u(i.dataObject.modified_date)),1)])]),_:1})]),_:1}))}}),Ae={key:0},Se=["innerHTML"],Ce={key:1},Ue={__name:"IDView",setup(i){const{mdAndUp:n}=Y(),u=new ee,h=M(),j=te(),{id:y,objectTypePlural:l}=j.params,a=f(()=>{const p=h.getDataObjectById(y);if(!(!p||p["object-type"]!==ae(l)))return h.getDataObjectById(y)}),e=f(()=>{let p={};return a.value&&a.value.relatedObjects&&Object.keys(a.value.relatedObjects).forEach(s=>{Array.isArray(a.value.relatedObjects[s])&&typeof a.value.relatedObjects[s][0]!="string"&&(p[s]=a.value.relatedObjects[s])}),p});f(()=>Object.fromEntries(Object.entries(e.value).filter(([p])=>p=="subtechniques"||p=="other subtechniques")));const d=f(()=>{const p=["tactic","tactics","subtechniques","other subtechniques","case-study","parent-technique"];if(e.value?.mitigation&&(e.value.mitigation=e.value.mitigation.map(s=>({...s,label:s.name,columnNames:["description"]}))),e.value["case-study"]&&a.value["object-type"]=="technique"){const s=[];e.value["case-study"].forEach(b=>{b.procedure.forEach(k=>{k.technique==a.value.id&&s.push({id:b.id,name:b.name,actor:b.actor,tactic:{name:e.value.tactic?e.value.tactic.filter(_=>_.id==k.tactic)[0].name:e.value.tactics.filter(_=>_.id==k.tactic)[0].name,route:e.value.tactic?e.value.tactic.filter(_=>_.id==k.tactic)[0].route:e.value.tactics.filter(_=>_.id==k.tactic)[0].route},description:k.description,"object-type":"procedure_examples",label:b.name,columnNames:["actor","tactic","description"],route:b.route})})}),e.value.procedure_examples=s}return Object.fromEntries(Object.entries(e.value).filter(([s])=>!p.includes(s)))}),c=f(()=>{const p=["procedure_examples","case-study","mitigation"],s=[];return p.forEach(b=>{Object.keys(d.value).includes(b)&&s.push({[b]:d.value[b]})}),Object.keys(d.value).forEach(b=>{p.includes(b)||s.push({[b]:d.value[b]})}),s}),V=f(()=>a.value&&"subtechnique-of"in a.value?`${h.getParent(a.value).name}: ${a.value.name}`:a.value?a.value.name:"No Title Found");return(p,s)=>a.value!=null?(t(),r("div",Ae,[m(oe,{pageTitle:V.value},null,8,["pageTitle"]),m(H,null,{default:o(()=>[m(I,{cols:v(n)?9:12},{default:o(()=>[m($,null,{default:o(()=>[O("div",{innerHTML:v(u).render(a.value.description)},null,8,Se)]),_:1})]),_:1},8,["cols"]),m(I,{cols:v(n)?3:12},{default:o(()=>[m($e,{"data-object":a.value,style:{border:"1px solid black","border-radius":"25px"}},null,8,["data-object"])]),_:1},8,["cols"])]),_:1}),(t(!0),r(x,null,w(c.value,b=>(t(),r("div",null,[(t(!0),r(x,null,w(b,(k,_)=>(t(),T(me,{key:_,itemType:_,items:k,parentObject:a.value},null,8,["itemType","items","parentObject"]))),128))]))),256))])):(t(),r("div",Ce,[m(ce)]))}};export{Ue as default};
