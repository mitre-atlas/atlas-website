import{c as m,a as d,o as n,w as e,b as B,g as l,K as I,I as G,d as h,f as p,C as q,r as N,am as J,s as c,e as U,y as O,af as Q,aj as W,aq as X,m as L,i as M,h as $,at as Y,j as Z,L as ee,q as te,t as S}from"./index-DkO2sVmX.js";import{V as ae}from"./VTooltip-CF_52eFU.js";import{V as se,a as j}from"./filter-CAaqlnxo.js";import{V as ne}from"./VDataTable-CLDPZdbM.js";const le=B("span",null,[B("span",{class:"attack-and"},"&"),h(" indicates an adaptation from ATT&CK ")],-1),oe={__name:"AttackIconToolTip",props:["items"],setup(y){const{items:k}=y;return(_,x)=>y.items.some(g=>"ATT&CK-reference"in g)?(n(),m(ae,{key:0},{activator:e(({props:g})=>[l(I,G({size:"small"},g),{default:e(()=>[h(" mdi-information-outline ")]),_:2},1040)]),default:e(()=>[le]),_:1})):d("",!0)}},E={__name:"TableFilter",props:["categories","stages"],emits:["updateFilters"],setup(y,{emit:k}){const{categories:_,stages:x}=y,g=k,w=p(()=>_?"category":"ML-lifecycle");let i=q(_||x);const V=N([]);function v(){g("updateFilters",w.value,V.value)}const C=N([]);D();async function D(){try{C.value=await J();const f=C.value.map(u=>u.name);i.sort((u,T)=>f.indexOf(u)-f.indexOf(T))}catch(f){console.error("Failed to fetch descriptions:",f),C.value=[]}}return(f,u)=>(n(),m(se,{modelValue:V.value,"onUpdate:modelValue":[u[0]||(u[0]=T=>V.value=T),v],clearable:"",chips:"",label:`Filter by ${w.value==="category"?"category":"ML lifecycle stage"}`,items:c(i),multiple:""},null,8,["modelValue","label","items"]))}},re={key:0},ie={key:1},ce={key:0,class:"attack-and"},ue=["innerHTML"],de={key:1},_e={__name:"InfoTable",props:["items","itemType"],setup(y){const{smAndDown:k}=U(),{mdAndUp:_}=U(),x=O("markdownit"),g=Q();let{objectTypePlural:w}=g.params;const{items:i,itemType:V}=y,v=q({category:[],"ML-lifecycle":[]}),C=p(()=>!(V=="mitigation"||V=="procedure_examples")),D=p(()=>v.category.length===0&&v["ML-lifecycle"].length===0?i:i.filter(t=>v.category.every(a=>t.category.includes(a))&&v["ML-lifecycle"].every(a=>t["ML-lifecycle"].includes(a))));function f(t,a){v[t]=a}const u=p(()=>i.reduce((t,a)=>("category"in a&&a.category.forEach(o=>{t.includes(o)||t.push(o)}),t),[])),T=p(()=>i.reduce((t,a)=>("ML-lifecycle"in a&&a["ML-lifecycle"].forEach(o=>{t.includes(o)||t.push(o)}),t),[])),z=p(()=>{let t=[{title:"ID",key:"id",align:_.value?"start":" d-none"},{title:"Name",key:"name",align:"start"}];const a=K.value.map(o=>({value:o,title:W(o),sortable:!1}));return t.concat(a)}),K=p(()=>"columnNames"in i[0]?i[0].columnNames:["description"]),b=N(""),A=p(()=>i[0].columnNames?i[0].columnNames[0]!=="use":!0);let F=N(!1);function H(){F.value=!F.value,b.value=""}function P(t){return t.length>150?t.substring(0,150)+"...":t}return(t,a)=>{const o=X("router-link");return n(),L("div",null,[C.value?(n(),m($,{key:0,class:"mb-3"},{default:e(()=>[l(M,{cols:c(k)?12:""},{default:e(()=>[A.value?(n(),m(j,{key:0,modelValue:b.value,"onUpdate:modelValue":a[0]||(a[0]=s=>b.value=s),label:"Search for Keywords","append-inner-icon":"mdi-magnify","hide-details":""},null,8,["modelValue"])):(n(),m($,{key:1,"no-gutters":""},{default:e(()=>[l(Y),l(M,null,{default:e(()=>[c(F)?(n(),m(j,{key:0,modelValue:b.value,"onUpdate:modelValue":a[1]||(a[1]=s=>b.value=s),density:"compact",label:"Search for Keywords"},null,8,["modelValue"])):d("",!0)]),_:1}),l(M,{sm:"1"},{default:e(()=>[l(Z,{variant:c(F)===!1?"outlined":"text",onClick:H},{default:e(()=>[l(I,null,{default:e(()=>[h("mdi-magnify")]),_:1}),h(" Search ")]),_:1},8,["variant"])]),_:1})]),_:1}))]),_:1},8,["cols"]),u.value.length>0?(n(),m(M,{key:0,cols:c(k)?6:""},{default:e(()=>[l(E,{categories:u.value,onUpdateFilters:f},null,8,["categories"])]),_:1},8,["cols"])):d("",!0),T.value.length>0?(n(),m(M,{key:1,cols:c(k)?6:""},{default:e(()=>[l(E,{stages:T.value,onUpdateFilters:f},null,8,["stages"])]),_:1},8,["cols"])):d("",!0)]),_:1})):d("",!0),l(ne,{items:D.value,headers:z.value,sortBy:c(w)==="studies"?[{key:"id",order:"desc"}]:[],search:b.value,"items-per-page":"-1"},ee({"header.name":e(({column:s,isSorted:r,getSortIcon:R})=>[B("span",null,[h(S(s.title)+" ",1),l(oe,{items:y.items},null,8,["items"])]),r(s)?(n(),m(I,{key:0,icon:R(s)},null,8,["icon"])):d("",!0)]),"item.id":e(({item:s,value:r})=>[l(o,{to:s.route},{default:e(()=>[h(S(r),1)]),_:2},1032,["to"])]),"item.name":e(({item:s,value:r})=>[l(o,{to:s.route},{default:e(()=>["label"in s?(n(),L("div",re,S(s.label),1)):(n(),L("div",ie,S(r),1))]),_:2},1032,["to"]),"ATT&CK-reference"in s?(n(),L("span",ce,"&")):d("",!0)]),bottom:e(()=>[]),_:2},[te(K.value,s=>({name:`item.${s}`,fn:e(({value:r})=>[typeof r=="string"?(n(),L("div",{key:0,innerHTML:c(_)?c(x).render(r):c(x).render(P(r))},null,8,ue)):d("",!0),typeof r=="object"?(n(),L("div",de,[l(o,{to:r.route},{default:e(()=>[h(S(r.name),1)]),_:2},1032,["to"])])):d("",!0)])}))]),1032,["items","headers","sortBy","search"])])}}};export{_e as _};
